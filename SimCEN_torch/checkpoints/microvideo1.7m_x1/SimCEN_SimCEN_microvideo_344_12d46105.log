2024-04-07 11:36:18,870 P2968489 INFO Params: {
    "alpha": "0.0001",
    "batch_size": "10000",
    "cl_temperature": "0.2",
    "data_format": "csv",
    "data_root": "../../../data/MicroVideo1.7M/",
    "dataset_id": "microvideo1.7m_x1",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "ego_batch_norm": "True",
    "ego_dropout": "0.1",
    "ego_hidden_activations": "relu",
    "embedding_dim": "64",
    "embedding_regularizer": "0.005",
    "embedding_share": "True",
    "epochs": "100",
    "eval_steps": "None",
    "feature_cols": "[{'active': True, 'dtype': 'int', 'name': 'group_id', 'preprocess': 'copy_from(user_id)', 'remap': False, 'type': 'meta'}, {'active': True, 'dtype': 'str', 'name': 'user_id', 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'embedding_dim': 64, 'name': 'item_id', 'pretrained_emb': '../../../data/MicroVideo1.7M_x1/item_image_emb_dim64.h5', 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'name': 'cate_id', 'type': 'categorical'}, {'active': True, 'dtype': 'str', 'embedding_dim': 64, 'max_len': 100, 'name': 'clicked_items', 'padding': 'pre', 'pretrained_emb': '../../../data/MicroVideo1.7M_x1/item_image_emb_dim64.h5', 'splitter': '^', 'type': 'sequence'}, {'active': True, 'dtype': 'str', 'max_len': 100, 'name': 'clicked_categories', 'padding': 'pre', 'share_embedding': 'cate_id', 'splitter': '^', 'type': 'sequence'}, {'active': False, 'dtype': 'str', 'name': 'timestamp', 'type': 'categorical'}]",
    "feature_config": "None",
    "feature_specs": "[{'feature_encoder': 'nn.Linear(64, 64, bias=False)', 'name': 'item_id'}, {'feature_encoder': ['layers.MaskedAveragePooling()', 'nn.Linear(64, 64, bias=False)'], 'name': 'clicked_items'}, {'feature_encoder': 'layers.MaskedAveragePooling()', 'name': 'clicked_categories'}]",
    "gpu": "0",
    "group_id": "None",
    "label_col": "{'dtype': 'float', 'name': 'is_click'}",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "min_categr_count": "1",
    "mlep1_hidden_units": "[480, 480, 480]",
    "mlep2_hidden_units": "[480, 480, 480]",
    "model": "SimCEN_SimCENv2",
    "model_id": "SimCEN_SimCEN_microvideo_344_12d46105",
    "model_root": "./checkpoints/",
    "monitor": "{'AUC': 1, 'logloss': -1}",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_workers": "10",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2024",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../../data/MicroVideo1.7M_x1/test.csv",
    "through_dropout": "0.3",
    "train_data": "../../../data/MicroVideo1.7M_x1/train.csv",
    "use_features": "None",
    "v1_batch_norm": "True",
    "v1_dropout": "0.2",
    "v1_hidden_activations": "mish",
    "v2_batch_norm": "True",
    "v2_dropout": "0.1",
    "v2_hidden_activations": "gelu",
    "valid_data": "../../../data/MicroVideo1.7M_x1/test.csv",
    "verbose": "1"
}
2024-04-07 11:36:18,871 P2968489 INFO Set up feature processor...
2024-04-07 11:36:18,872 P2968489 WARNING Skip rebuilding ../../../data/MicroVideo1.7M/microvideo1.7m_x1/feature_map.json. Please delete it manually if rebuilding is required.
2024-04-07 11:36:18,872 P2968489 INFO Load feature_map from json: ../../../data/MicroVideo1.7M/microvideo1.7m_x1/feature_map.json
2024-04-07 11:36:18,872 P2968489 INFO Set column index...
2024-04-07 11:36:18,872 P2968489 INFO Feature specs: {
    "cate_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 513, 'vocab_size': 514}",
    "clicked_categories": "{'source': '', 'type': 'sequence', 'feature_encoder': 'layers.MaskedAveragePooling()', 'share_embedding': 'cate_id', 'padding_idx': 0, 'oov_idx': 513, 'vocab_size': 514, 'max_len': 100}",
    "clicked_items": "{'source': '', 'type': 'sequence', 'feature_encoder': ['layers.MaskedAveragePooling()', 'nn.Linear(64, 64, bias=False)'], 'embedding_dim': 64, 'pretrained_emb': 'pretrained_emb.h5', 'freeze_emb': True, 'padding_idx': 0, 'oov_idx': 1704881, 'vocab_size': 1704882, 'max_len': 100}",
    "group_id": "{'type': 'meta'}",
    "item_id": "{'source': '', 'type': 'categorical', 'embedding_dim': 64, 'pretrained_emb': 'pretrained_emb.h5', 'freeze_emb': True, 'padding_idx': 0, 'oov_idx': 1704881, 'vocab_size': 1704882, 'feature_encoder': 'nn.Linear(64, 64, bias=False)'}",
    "user_id": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 10987, 'vocab_size': 10988}"
}
2024-04-07 11:36:33,273 P2968489 INFO Total number of parameters: 2768257.
2024-04-07 11:36:33,273 P2968489 INFO Loading data...
2024-04-07 11:36:33,273 P2968489 INFO Loading data from h5: ../../../data/MicroVideo1.7M/microvideo1.7m_x1/train.h5
2024-04-07 11:36:44,519 P2968489 INFO Train samples: total/8970309, blocks/1
2024-04-07 11:36:44,520 P2968489 INFO Loading data from h5: ../../../data/MicroVideo1.7M/microvideo1.7m_x1/valid.h5
2024-04-07 11:36:49,525 P2968489 INFO Validation samples: total/3767308, blocks/1
2024-04-07 11:36:49,525 P2968489 INFO Loading train and validation data done.
2024-04-07 11:36:49,525 P2968489 INFO Start training: 898 batches/epoch
2024-04-07 11:36:49,525 P2968489 INFO ************ Epoch=1 start ************
2024-04-07 11:37:52,068 P2968489 INFO Train loss: 0.513693
2024-04-07 11:37:52,069 P2968489 INFO Evaluation @epoch 1 - batch 898: 
2024-04-07 11:38:08,642 P2968489 INFO ===
2024-04-07 11:38:08,642 P2968489 INFO [Metrics] AUC: 0.710159 - logloss: 0.420369
2024-04-07 11:38:08,654 P2968489 INFO Save best model: monitor(max)=0.289790
2024-04-07 11:38:10,985 P2968489 INFO ************ Epoch=1 end ************
2024-04-07 11:39:09,391 P2968489 INFO Train loss: 0.457880
2024-04-07 11:39:09,391 P2968489 INFO Evaluation @epoch 2 - batch 898: 
2024-04-07 11:39:31,037 P2968489 INFO ===
2024-04-07 11:39:31,037 P2968489 INFO [Metrics] AUC: 0.711406 - logloss: 0.418205
2024-04-07 11:39:31,050 P2968489 INFO Save best model: monitor(max)=0.293200
2024-04-07 11:39:37,558 P2968489 INFO ************ Epoch=2 end ************
2024-04-07 11:40:37,335 P2968489 INFO Train loss: 0.454433
2024-04-07 11:40:37,335 P2968489 INFO Evaluation @epoch 3 - batch 898: 
2024-04-07 11:40:59,001 P2968489 INFO ===
2024-04-07 11:40:59,002 P2968489 INFO [Metrics] AUC: 0.715396 - logloss: 0.416453
2024-04-07 11:40:59,007 P2968489 INFO Save best model: monitor(max)=0.298942
2024-04-07 11:41:05,228 P2968489 INFO ************ Epoch=3 end ************
2024-04-07 11:42:09,874 P2968489 INFO Train loss: 0.452631
2024-04-07 11:42:09,875 P2968489 INFO Evaluation @epoch 4 - batch 898: 
2024-04-07 11:42:26,565 P2968489 INFO ===
2024-04-07 11:42:26,566 P2968489 INFO [Metrics] AUC: 0.717282 - logloss: 0.418176
2024-04-07 11:42:26,569 P2968489 INFO Save best model: monitor(max)=0.299105
2024-04-07 11:42:32,925 P2968489 INFO ************ Epoch=4 end ************
2024-04-07 11:43:30,379 P2968489 INFO Train loss: 0.451977
2024-04-07 11:43:30,380 P2968489 INFO Evaluation @epoch 5 - batch 898: 
2024-04-07 11:43:51,901 P2968489 INFO ===
2024-04-07 11:43:51,901 P2968489 INFO [Metrics] AUC: 0.718208 - logloss: 0.417813
2024-04-07 11:43:51,904 P2968489 INFO Save best model: monitor(max)=0.300394
2024-04-07 11:43:58,319 P2968489 INFO ************ Epoch=5 end ************
2024-04-07 11:44:58,803 P2968489 INFO Train loss: 0.451358
2024-04-07 11:44:58,804 P2968489 INFO Evaluation @epoch 6 - batch 898: 
2024-04-07 11:45:20,923 P2968489 INFO ===
2024-04-07 11:45:20,923 P2968489 INFO [Metrics] AUC: 0.719394 - logloss: 0.416162
2024-04-07 11:45:20,926 P2968489 INFO Save best model: monitor(max)=0.303232
2024-04-07 11:45:26,263 P2968489 INFO ************ Epoch=6 end ************
2024-04-07 11:46:28,769 P2968489 INFO Train loss: 0.450595
2024-04-07 11:46:28,770 P2968489 INFO Evaluation @epoch 7 - batch 898: 
2024-04-07 11:46:51,501 P2968489 INFO ===
2024-04-07 11:46:51,501 P2968489 INFO [Metrics] AUC: 0.719836 - logloss: 0.414938
2024-04-07 11:46:51,522 P2968489 INFO Save best model: monitor(max)=0.304898
2024-04-07 11:46:57,582 P2968489 INFO ************ Epoch=7 end ************
2024-04-07 11:48:00,516 P2968489 INFO Train loss: 0.449667
2024-04-07 11:48:00,517 P2968489 INFO Evaluation @epoch 8 - batch 898: 
2024-04-07 11:48:23,545 P2968489 INFO ===
2024-04-07 11:48:23,545 P2968489 INFO [Metrics] AUC: 0.719292 - logloss: 0.416482
2024-04-07 11:48:23,549 P2968489 INFO Monitor(max)=0.302810 STOP!
2024-04-07 11:48:23,550 P2968489 INFO Reduce learning rate on plateau: 0.000100
2024-04-07 11:48:23,844 P2968489 INFO ************ Epoch=8 end ************
2024-04-07 11:49:30,199 P2968489 INFO Train loss: 0.432563
2024-04-07 11:49:30,200 P2968489 INFO Evaluation @epoch 9 - batch 898: 
2024-04-07 11:49:53,543 P2968489 INFO ===
2024-04-07 11:49:53,543 P2968489 INFO [Metrics] AUC: 0.732626 - logloss: 0.411493
2024-04-07 11:49:53,545 P2968489 INFO Save best model: monitor(max)=0.321133
2024-04-07 11:49:58,753 P2968489 INFO ************ Epoch=9 end ************
2024-04-07 11:50:59,162 P2968489 INFO Train loss: 0.427861
2024-04-07 11:50:59,163 P2968489 INFO Evaluation @epoch 10 - batch 898: 
2024-04-07 11:51:22,302 P2968489 INFO ===
2024-04-07 11:51:22,302 P2968489 INFO [Metrics] AUC: 0.734038 - logloss: 0.411027
2024-04-07 11:51:22,313 P2968489 INFO Save best model: monitor(max)=0.323011
2024-04-07 11:51:27,639 P2968489 INFO ************ Epoch=10 end ************
2024-04-07 11:52:29,667 P2968489 INFO Train loss: 0.425076
2024-04-07 11:52:29,668 P2968489 INFO Evaluation @epoch 11 - batch 898: 
2024-04-07 11:52:55,052 P2968489 INFO ===
2024-04-07 11:52:55,053 P2968489 INFO [Metrics] AUC: 0.733403 - logloss: 0.411709
2024-04-07 11:52:55,057 P2968489 INFO Monitor(max)=0.321694 STOP!
2024-04-07 11:52:55,057 P2968489 INFO Reduce learning rate on plateau: 0.000010
2024-04-07 11:52:55,301 P2968489 INFO ************ Epoch=11 end ************
2024-04-07 11:54:01,024 P2968489 INFO Train loss: 0.409300
2024-04-07 11:54:01,024 P2968489 INFO Evaluation @epoch 12 - batch 898: 
2024-04-07 11:54:17,553 P2968489 INFO ===
2024-04-07 11:54:17,553 P2968489 INFO [Metrics] AUC: 0.731700 - logloss: 0.418829
2024-04-07 11:54:17,561 P2968489 INFO Monitor(max)=0.312871 STOP!
2024-04-07 11:54:17,561 P2968489 INFO Reduce learning rate on plateau: 0.000001
2024-04-07 11:54:17,561 P2968489 INFO ********* Epoch==12 early stop *********
2024-04-07 11:54:17,707 P2968489 INFO Training finished.
2024-04-07 11:54:17,708 P2968489 INFO Load best model: /mnt/public/lhh/code/model_zoo/SimCEN/SimCEN_torch/checkpoints/microvideo1.7m_x1/SimCEN_SimCEN_microvideo_344_12d46105.model
2024-04-07 11:54:18,284 P2968489 INFO ****** Validation evaluation ******
2024-04-07 11:54:33,949 P2968489 INFO ===
2024-04-07 11:54:33,949 P2968489 INFO [Metrics] logloss: 0.411027 - AUC: 0.734038
2024-04-07 11:54:34,045 P2968489 INFO ******** Test evaluation ********
2024-04-07 11:54:34,045 P2968489 INFO Loading data...
2024-04-07 11:54:34,045 P2968489 INFO Loading data from h5: ../../../data/MicroVideo1.7M/microvideo1.7m_x1/test.h5
2024-04-07 11:54:38,618 P2968489 INFO Test samples: total/3767308, blocks/1
2024-04-07 11:54:38,618 P2968489 INFO Loading test data done.
2024-04-07 11:54:53,726 P2968489 INFO ===
2024-04-07 11:54:53,726 P2968489 INFO [Metrics] logloss: 0.411027 - AUC: 0.734038
